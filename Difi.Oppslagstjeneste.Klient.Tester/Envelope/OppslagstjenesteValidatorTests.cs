using System.Text;
using ApiClientShared;
using Difi.Oppslagstjeneste.Klient.Tester;
using Difi.Oppslagstjeneste.Klient.Tester.Envelope;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Difi.Oppslagstjeneste.Klient.Envelope.Tests
{
    [TestClass]
    public class OppslagstjenesteValidatorTests
    {
        [TestClass]
        public class KonstruktørMethod : OppslagstjenesteValidatorTests
        {
            [TestMethod]
            public void EnkelKonstruktør()
            {
                //Arrange
                var mottattTekst =
                    "<env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\"><env:Header><wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"true\"><xenc:EncryptedKey xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"EK-93174122FB0647AACA1455886603704343357\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\" /><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><wsse:SecurityTokenReference><ds:X509Data><ds:X509IssuerSerial><ds:X509IssuerName>CN=Buypass Class 3 Test4 CA 3,O=Buypass AS-983163327,C=NO</ds:X509IssuerName><ds:X509SerialNumber>113797202800340228423187</ds:X509SerialNumber></ds:X509IssuerSerial></ds:X509Data></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>F2+rKoWNIkKN9blDtgdhbAsp8kDGBApKcdiXXlINr0psv6FAF0KqW8dowDGjOOZ4XXRmwVvZ6J8fA9H8DNB7qoR0p5f5RqMIiyZRDJIcZODU8BStmXz05PMZzjL+uyhsUq/9UwIis7g4ZXUiMKw8gk7Fp4uH5mFlavVqC//ORq3/7JchtvN4ptuv+aq1X38ovuq4bVXcEZOxhyWdQg7udXFeIKOY24ykZsXnhoBdGzT4OMX/oTNESS+wAVLIf5CuBAoRfYOeviyAUHGxyLSav/3LJPwEmhjN6mMwTezpPp65uKjMfZ+lBDiengHG++ePNUxZ3kNTZKzTrOotNO+UnQ==</xenc:CipherValue></xenc:CipherData><xenc:ReferenceList><xenc:DataReference URI=\"#ED-93174122FB0647AACA1455886603704343358\" /></xenc:ReferenceList></xenc:EncryptedKey><wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"X509-93174122FB0647AACA1455886603692343352\">MIIE9zCCA9+gAwIBAgIKMbZ4wGiF3IUUOzANBgkqhkiG9w0BAQUFADBLMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxHTAbBgNVBAMMFEJ1eXBhc3MgQ2xhc3MgMyBDQSAzMB4XDTEzMDMwNzE0MDAzOFoXDTE2MDMwNzE0MDAzNVowgYsxCzAJBgNVBAYTAk5PMSwwKgYDVQQKDCNESVJFS1RPUkFURVQgRk9SIEZPUlZBTFROSU5HIE9HIElLVDEMMAoGA1UECwwDVkVSMSwwKgYDVQQDDCNESVJFS1RPUkFURVQgRk9SIEZPUlZBTFROSU5HIE9HIElLVDESMBAGA1UEBRMJOTkxODI1ODI3MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtRTwCP3aPXB61np2eF+ebEZTTz8ebMzSfpin8bbga65jubLOSN28JQHysCBZryghJkUHhs+xL8wP85DEpCT7DoIe+9Hyx84Ei2eHkpO5B4HaY8c1s6X2iABvEUC7TsHxvsf71ORuP77/CtR4U29BH4X0OUGu3yKJOUWSYfiHyIpwPkcdNs1jSkrvy6HJeCY0ICmdqTv/PzhHXS2pnGOt7aMkMQuHxmlgFO/wUeRmP4Rff3AUOPrPwk7OMhCeB219l7TNcd9Tb5xKySeVWDuHYzfjCM+5V86ZBNaGe6eFHfiFUMmGkmxtzcUqIsmSCH1fwIVBTpfnE6MS4WMo6TfsKQIDAQABo4IBmjCCAZYwCQYDVR0TBAIwADAfBgNVHSMEGDAWgBTMw/gHt5xtek71pysdBfmzRxyR0TAdBgNVHQ4EFgQUR3iI9AQJNcfdr1Pp2c25VNGVAkUwDgYDVR0PAQH/BAQDAgSwMBUGA1UdIAQOMAwwCgYIYIRCARoBAwIwgaUGA1UdHwSBnTCBmjAvoC2gK4YpaHR0cDovL2NybC5idXlwYXNzLm5vL2NybC9CUENsYXNzM0NBMy5jcmwwZ6BloGOGYWxkYXA6Ly9sZGFwLmJ1eXBhc3Mubm8vZGM9QnV5cGFzcyxkYz1OTyxDTj1CdXlwYXNzJTIwQ2xhc3MlMjAzJTIwQ0ElMjAzP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QwegYIKwYBBQUHAQEEbjBsMDMGCCsGAQUFBzABhidodHRwOi8vb2NzcC5idXlwYXNzLm5vL29jc3AvQlBDbGFzczNDQTMwNQYIKwYBBQUHMAKGKWh0dHA6Ly9jcnQuYnV5cGFzcy5uby9jcnQvQlBDbGFzczNDQTMuY2VyMA0GCSqGSIb3DQEBBQUAA4IBAQDZpzajceMe9vwzY01BIafvcLX70WHxNUz2q5beYxW1+RDchr6wvznTChhpmuPuWp3Kuq9nD7kkZgIaiqUcjH1Fuv2Jo0wEC8OtJAlUfIcyGh/o3s/u761Qq84viEV50cyXaUX9ryzdDgkxujgx1nFY0rnGWiHoM1jDSglTLfCOrd/ofF+Mr9gLVFl+AlZ3waIbhidlEC0fw05OTXPJ9sc3LJ+1QwV3DsZwjciL+ZIqS2Cg4NXvNe1C8KpGUGoPN4gBWleB8WjyY1uTyz8ssE9+8ETMWnxCrxY6/rfm01iK0ZSFtqYl9Wdg1xydkaTOrtGwi422Y0KOzixrsau1eMRh</wsse:BinarySecurityToken><ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\" Id=\"SIG-93174122FB0647AACA1455886603698343356\"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /><ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\" /><ds:Reference URI=\"#TS-93174122FB0647AACA1455886603692343351\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><ds:DigestValue>1/4Ow24PnIwGGc2hbPGdc+rLKQiNSpcc4Pe4HKhK8EU=</ds:DigestValue></ds:Reference><ds:Reference URI=\"#id-93174122FB0647AACA1455886603692343355\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><ds:DigestValue>oA/BWjhw9iYfaoGYglV48WW9qny1jXartgqtvxbVJ3g=</ds:DigestValue></ds:Reference><ds:Reference URI=\"#SC-93174122FB0647AACA1455886603691343350\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><ds:DigestValue>aWVX++YUFdQBrCG6G+y6rXgPvBHnANh38S8tk/bFGH0=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>nhulaoklf79KdS6gIcDOIQZG+8SEYunvfVdOadWEr8YZ8gnc/ve1XvXdp7tkf91jXS60dPole9BK998IpRK8ih6ZF/3BDAL0zgI7dMeI2iuY9tYDe8+7UaQQLKhwBqnBwofdiG6gOcbZkye6tyc4WD6aaTjdntJDjkUOXPPUp+TqXT7OsWtay28Qxo8Q8ZwhLiEux7TjWLYSljOMAoAfeJd/hpjPzcDnuxExL0hls7WymO/wI+RqX9bn5gFsxjFdOvGcxvXCObbo9MIwfHomN3yb4dKNz6Ee7VtXEjbAHTX0TnOk7hFgVwcfchkOU3WOxcXRMw7BXQVMIZun513anw==</ds:SignatureValue><ds:KeyInfo Id=\"KI-93174122FB0647AACA1455886603692343353\"><wsse:SecurityTokenReference wsu:Id=\"STR-93174122FB0647AACA1455886603692343354\"><wsse:Reference URI=\"#X509-93174122FB0647AACA1455886603692343352\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" /></wsse:SecurityTokenReference></ds:KeyInfo></ds:Signature><wsu:Timestamp wsu:Id=\"TS-93174122FB0647AACA1455886603692343351\"><wsu:Created>2016-02-19T12:56:43.691Z</wsu:Created><wsu:Expires>2016-02-19T12:57:43.691Z</wsu:Expires></wsu:Timestamp><wsse11:SignatureConfirmation xmlns:wsse11=\"http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd\" Value=\"FxQesiuGdCV3WNQKnG+eJ+viiumHyBBq1xDuX+k9YPEGYNXHNXYPm9ghhLbZ1b1uxTJowzVH++2gkLTSvjW4Mm65ccPT8XZDX+0md/jxVa7vZigVGWc4r38P6eap47gvzRNes3FeC2zRz8x/dSlqSN/0Oc+nKbUZtxa9Jm35UGKxwaWrDRfjyh2I6cnVrcOevY+SFnb47M+I+JzMPFrzklpFJ7XttmWJZ6aAUmuSRkDyYGmn+mjsATb8sf8WI66emLNC04GZa3l1eN/oFd7TuHifvNCAjYO0RnLs05E2Isj+RS9xlfMSUmZcGbqgq9qWkUzB99NJik2b4o30Hmt8Jg==\" wsu:Id=\"SC-93174122FB0647AACA1455886603691343350\" /></wsse:Security></env:Header><env:Body xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"id-93174122FB0647AACA1455886603692343355\"><xenc:EncryptedData xmlns:xenc=\"http://www.w3.org/2001/04/xmlenc#\" Id=\"ED-93174122FB0647AACA1455886603704343358\" Type=\"http://www.w3.org/2001/04/xmlenc#Content\"><xenc:EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes256-cbc\" /><ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"><wsse:SecurityTokenReference xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsse11=\"http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd\" wsse11:TokenType=\"http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey\"><wsse:Reference URI=\"#EK-93174122FB0647AACA1455886603704343357\" /></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>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</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></env:Body></env:Envelope>";
                var sendtTekst =
                    "<?xml version=\"1.0\" encoding=\"UTF - 8\"?><soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\"><soap:Header><wsse:Security xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"><wsu:Timestamp wsu:Id=\"TS-80a68aca-5e06-47aa-baff-ced089909fcb\"><wsu:Created>2016-02-19T12:55:51.556Z</wsu:Created><wsu:Expires>2016-02-19T13:25:51.556Z</wsu:Expires></wsu:Timestamp><wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"X509-b9ed18c5-1833-4f89-9813-f6878296a1f6\">MIIE7jCCA9agAwIBAgIKGBj1bv99Jpi+EzANBgkqhkiG9w0BAQsFADBRMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxIzAhBgNVBAMMGkJ1eXBhc3MgQ2xhc3MgMyBUZXN0NCBDQSAzMB4XDTE0MDQyNDEyMzExMVoXDTE3MDQyNDIxNTkwMFowVTELMAkGA1UEBhMCTk8xGDAWBgNVBAoMD1BPU1RFTiBOT1JHRSBBUzEYMBYGA1UEAwwPUE9TVEVOIE5PUkdFIEFTMRIwEAYDVQQFEwk5ODQ2NjExODUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDLTnQryf2bmiyQ9q3ylQ6xMl7EhGIbjuziXkRTfL+M94m3ceAiko+r2piefKCiquLMK4j+UDcOapUtLC4dT4c6GhRH4FIOEn5aNS2I/njTenBypWka/VEhQUj7zvIh5G4UXIDIXYvLd7gideeMtkX24KUh2XVlh+PcqLGHirqBwVfFiTn5SKhr/ojhYYEb2xxTk3AY9nLd1MMffKQwUWmfoTos4scREYGI2R2vWxKWPcDqk+jig2DISWSJSuerz3HMYAAmp+Gjt0oFJNiyOFaFyGwT3DvqwOMQWwWXdmLh1NxMgTpghXAaXae76ucm9GDQ9E7ytf+JA096RWoi+5GtAgMBAAGjggHCMIIBvjAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFD+u9XgLkqNwIDVfWvr3JKBSAfBBMB0GA1UdDgQWBBTVyVLqcjWf1Qd0gsmCTrhXiWeqVDAOBgNVHQ8BAf8EBAMCBLAwFgYDVR0gBA8wDTALBglghEIBGgEAAwIwgbsGA1UdHwSBszCBsDA3oDWgM4YxaHR0cDovL2NybC50ZXN0NC5idXlwYXNzLm5vL2NybC9CUENsYXNzM1Q0Q0EzLmNybDB1oHOgcYZvbGRhcDovL2xkYXAudGVzdDQuYnV5cGFzcy5uby9kYz1CdXlwYXNzLGRjPU5PLENOPUJ1eXBhc3MlMjBDbGFzcyUyMDMlMjBUZXN0NCUyMENBJTIwMz9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0MIGKBggrBgEFBQcBAQR+MHwwOwYIKwYBBQUHMAGGL2h0dHA6Ly9vY3NwLnRlc3Q0LmJ1eXBhc3Mubm8vb2NzcC9CUENsYXNzM1Q0Q0EzMD0GCCsGAQUFBzAChjFodHRwOi8vY3J0LnRlc3Q0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MzVDRDQTMuY2VyMA0GCSqGSIb3DQEBCwUAA4IBAQCmMpAGaNplOgx3b4Qq6FLEcpnMOnPlSWBC7pQEDWx6OtNUHDm56fBoyVQYKR6LuGfalnnOKuB/sGSmO3eYlh7uDK9WA7bsNU/W8ZiwYwF6PBRui2rrqYk3kj4NLTNlyh/AOO1a2FDFHu369W0zcjj5ns7qs0K3peXtLX8pVxA8RmjwdGe69P/2r6s2A5CBj7oXZJD0Yo2dJFdsZzonT900sUi+MWzlhj3LxU5/684NWc2NI6ZPof/dyYpy3K/AFzpDLWGSmaDO66hPl7EfoJxEiX0DNBaQzNIyRFPh0ir0jM+32ZQ4goR8bAtyhKeTyA/4+Qx1WQXS3wURCC0lsbMh</wsse:BinarySecurityToken><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\" /><Reference URI=\"#TS-80a68aca-5e06-47aa-baff-ced089909fcb\"><Transforms><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><InclusiveNamespaces PrefixList=\"wsse soapenv\" xmlns=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transform></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /><DigestValue>8gZl8WROzLPrE17qb05/pZWPH/o=</DigestValue></Reference><Reference URI=\"#id-43e6106f-f8d5-40cf-a772-edd8cb166aba\"><Transforms><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><InclusiveNamespaces PrefixList=\"\" xmlns=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transform></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /><DigestValue>F64aLLFFMOt4XTgpCRqxGhlDLLQ=</DigestValue></Reference></SignedInfo><SignatureValue>FxQesiuGdCV3WNQKnG+eJ+viiumHyBBq1xDuX+k9YPEGYNXHNXYPm9ghhLbZ1b1uxTJowzVH++2gkLTSvjW4Mm65ccPT8XZDX+0md/jxVa7vZigVGWc4r38P6eap47gvzRNes3FeC2zRz8x/dSlqSN/0Oc+nKbUZtxa9Jm35UGKxwaWrDRfjyh2I6cnVrcOevY+SFnb47M+I+JzMPFrzklpFJ7XttmWJZ6aAUmuSRkDyYGmn+mjsATb8sf8WI66emLNC04GZa3l1eN/oFd7TuHifvNCAjYO0RnLs05E2Isj+RS9xlfMSUmZcGbqgq9qWkUzB99NJik2b4o30Hmt8Jg==</SignatureValue><KeyInfo Id=\"KS-81713279-e27c-459c-88b8-1c39263256ea\"><wsse:SecurityTokenReference wsu:Id=\"STR-689da38a-3877-4b51-bd50-64b4033b2e78\"><Reference URI=\"#X509-b9ed18c5-1833-4f89-9813-f6878296a1f6\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" xmlns=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" /></wsse:SecurityTokenReference></KeyInfo></Signature></wsse:Security></soap:Header><soap:Body wsu:Id=\"id-43e6106f-f8d5-40cf-a772-edd8cb166aba\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"><ns:HentPersonerForespoersel xmlns:ns=\"http://kontaktinfo.difi.no/xsd/oppslagstjeneste/16-02\"><ns:informasjonsbehov>Kontaktinfo</ns:informasjonsbehov><ns:informasjonsbehov>Sertifikat</ns:informasjonsbehov><ns:informasjonsbehov>SikkerDigitalPost</ns:informasjonsbehov><ns:informasjonsbehov>VarslingsStatus</ns:informasjonsbehov><ns:personidentifikator>08077000292</ns:personidentifikator></ns:HentPersonerForespoersel></soap:Body></soap:Envelope>";
                var oppslagstjenesteInstillinger = new OppslagstjenesteInstillinger();
                var miljø = Miljø.FunksjoneltTestmiljø;

                //Act
                var mottattDokument = XmlUtility.TilXmlDokument(mottattTekst);
                var sendtDokument = XmlUtility.TilXmlDokument(sendtTekst);

                if (miljø != null)
                {
                    var oppslagstjenestevalidator = new Oppslagstjenestevalidator(sendtDokument, mottattDokument,
                        oppslagstjenesteInstillinger, miljø);

                    //Assert
                    Assert.AreEqual(sendtDokument, oppslagstjenestevalidator.SendtDokument);
                    Assert.AreEqual(mottattDokument, oppslagstjenestevalidator.MottattDokument);
                    Assert.AreEqual(oppslagstjenesteInstillinger, oppslagstjenestevalidator.OppslagstjenesteInstillinger);
                    Assert.AreEqual(miljø, oppslagstjenestevalidator.Miljø);
                }
            }
        }

        [TestClass]
        public class ValiderMethod : OppslagstjenesteValidatorTests
        {
            [Ignore]
            [TestMethod]
            public void ValiderermedGyldigXml()
            {
                //Arrange
                var resourceUtility = new ResourceUtility("Difi.Oppslagstjeneste.Klient.Tester");
                var sendtTekst =
                    Encoding.UTF8.GetString(resourceUtility.ReadAllBytes(true, "Ressurser.HentPersonerRequest.xml"));
                var mottattTekst =
                    Encoding.UTF8.GetString(resourceUtility.ReadAllBytes(true, "Ressurser.HentPersonerResponse.xml"));
                var sendtDokument = XmlUtility.TilXmlDokument(sendtTekst);
                var mottattDokument = XmlUtility.TilXmlDokument(mottattTekst);
                var oppslagstjenesteInstillinger = new OppslagstjenesteInstillinger();
                var miljø = Miljø.FunksjoneltTestmiljø;

                var oppslagstjenestevalidator = new OppslagstjenestevalidatorMedStubbetSjekkTimestamp(sendtDokument,
                    mottattDokument, oppslagstjenesteInstillinger, miljø);


                //Act
                oppslagstjenestevalidator.Valider();

                //Assert
                //Feiler om validering feiler.
            }
        }
    }
}